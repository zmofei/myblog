extends ../layout.jade

block title
    title 博客 - I'm Mofei

block css
    link(rel="stylesheet" href= host + "/css/blog.css")

block javascript
    script(src= host + "/js/tools/utility.js")
    script(src= host + "/js/blog/index.js")
    script(src= host + "/js/blog/blog.main.js")

block content    
    include ../common/nav.jade
    section.blog-content
        .blog-search-traget
            button(id="blog-search-tar")
                svg(fill="currentColor" preserveAspectRatio="xMidYMid meet" height="16" width="16" viewBox="0 0 16 16" style="vertical-align: middle;")
                    g(fill="#333333")
                        rect(x="0" y="3" width="18" height="2")
                    g(fill="#333333")
                        rect(x="0" y="8" width="18" height="2")
                    g(fill="#333333")
                        rect(x="0" y="13" width="18" height="2")
                    g
                        circle(fill="#333333" cx="4.5" cy="4" r="2.2")
                        circle(fill="#FFFFFF" cx="4.5" cy="4" r="0.8")
                    g
                        circle(fill="#333333" cx="13.5" cy="9" r="2.2")
                        circle(fill="#FFFFFF" cx="13.5" cy="9" r="0.8")
                    g
                        circle(fill="#333333" cx="9" cy="14" r="2.2")
                        circle(fill="#FFFFFF" cx="9" cy="14" r="0.8")
                | &nbsp;Category
        div.blog-search(id="blog-search-box")
            .blog-search-title 
                | Category
                button(id="blog-search-cls")
                    svg(viewBox="0 0 20 20" style="width: 10px; height: 10px; fill: #333;")
                        path(d="M19.8 2.4c.3.3.3.8 0 1.1l-6 6c-.3.3-.3.8 0 1.1l6 6c.3.3.3.8 0 1.1l-2.2 2.2c-.3.3-.8.3-1.1 0l-6-6c-.3-.3-.8-.3-1.1 0l-6 6c-.3.3-.8.3-1.1 0L.1 17.7c-.3-.3-.3-.8 0-1.1l6-6c.3-.3.3-.8 0-1.1l-6-6c-.3-.3-.3-.8 0-1.1L2.3.2c.3-.3.8-.3 1.1 0l6 6c.3.3.8.3 1.1 0l6-6c.3-.3.8-.3 1.1 0l2.2 2.2z")
                    | &nbsp;Close
            ul.blog-search-box
                a(href="/blog/1")
                    li.blog-search-tag.blog-search-tagAll All categories
                each blogclass in blogClass
                    a(href="/blog/1?tags=" + blogclass.classid)
                        li.blog-search-tag(id= 'tag_' + blogclass.classid)=  blogclass.classname 
                            span= blogclass.classcount
        div.blog-content-area
            if blogs
                each blog in blogs
                    div.blog-content-block
                        if (blog.coverFalse)
                            div.blog-content-img
                                a(href="/blog/article/" + blog._id)
                                    div.blog-content-img-body(style="background-image:url('" + blog.cover +"')")
                        div.blog-content-text(class= blog.coverFalse?'':'noimg')
                            a(href="/blog/article/" + blog._id)
                                h2= blog.title
                            div.blog-tag &#xe901; Tags:  
                                - var tags = blog.tags;
                                    each tag in tags
                                        a(href="/blog/1?tags=" + tag.id)= tag.name
                            a(href="/blog/article/" + blog._id)
                                div.blog-review= blog.content.replace(/\<.+?\>/g,'').replace(/(\!{0,1}\[.+?\]\(.+?\))|#|(`+?)|\*|=|-/g,' ').slice(0,180)+ ' ...'
                            div.blog-info
                                div.blog-time 
                                    span &#xe904;
                                    - var time = new Date(blog.pubtime);
                                    - var year = time.getFullYear();
                                    - var month = (time.getMonth()+1);
                                    - var date = time.getDate();
                                        span= year + '-' + (month < 10 ? '0' + month : month) + '-' + (date < 10 ? '0' + date : date)
                                div.blog-read
                                    span &#xe900; 
                                    span= (blog.visited||0) + ' '
                                    span &#xe903; 
                                    span= (blog.like||0) + ' '
                                    span &#xe902;  
                                    span= blog.comment||0 
    section.blog-pages
        if currentPage > 1
            a(href="/blog/" + (currentPage-1) + search) Previous
        - var showPre = showNext = true;
        - for (var i = 1; i <= totalPage; i++) 
            if (i == 1 || Math.abs(currentPage - i) <= 2 || i == totalPage)
                a(href="/blog/" + i + search class= (i == currentPage? 'active' : '') )= i
            else if ((currentPage - i) >=  2 && showPre)
                span ...
                - showPre = false;
            else if (i>currentPage && (totalPage - currentPage) >=  2 && showNext)
                span ...
                - showNext = false;
        if currentPage < totalPage
            a(href="/blog/" + (currentPage+1) + search) Next

    section.index-copyright
        div.index-copyright-bottom
            include ../copyright.jade
